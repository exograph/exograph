# See https://github.com/mozilla/application-services/blob/main/Cargo.toml for the reasons why we use this structure
[workspace]
members = [
    "crates/builder",
    "crates/cli",
    "crates/resolver",
    "crates/server-actix",
    "crates/server-aws-lambda",
    "crates/testing",
    "crates/core-subsystem/*",
    "crates/postgres-subsystem/*",
    "crates/deno-subsystem/*",
    "crates/wasm-subsystem/*",
    "crates/subsystem-util/*",
    "crates/introspection-subsystem/*",
    "libs/payas-deno",
    "libs/payas-sql",
    "libs/payas-wasm"
]

# The default workspace member to run `cargo` commands on (we exclude server-aws-lambda here, since we don't need to build it during normal development)
# Pass --all to `cargo` to include it)
default-members = [
    "crates/builder",
    "crates/cli",
    "crates/resolver",
    "crates/server-actix",
    "crates/testing",
    "crates/core-subsystem/*",
    "crates/postgres-subsystem/*",
    "crates/deno-subsystem/*",
    "crates/wasm-subsystem/*",
    "crates/subsystem-util/*",
    "crates/introspection-subsystem/*",
    "libs/payas-deno",
    "libs/payas-sql",
    "libs/payas-wasm"
]  
resolver = "2"

[profile.release]
lto = true
codegen-units = 1
strip = true
