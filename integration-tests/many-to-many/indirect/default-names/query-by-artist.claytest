# Exercises the use of deep joins. In this case, concert -> concertArtist -> artist
operation: |
  query($A1b_id: Int!) {
    artist1_concerts: concerts(where: {concertArtists: {artist: {name: {eq: "A1a"}}}}) {
      id
      concertArtists {
        artist {
          id
          name
        }
      }
    }
    artist2_concerts: concerts(where: {concertArtists: {artist: {name: {eq: "A1b"}}}}) {
      id
      concertArtists {
        artist {
          id
          name
        }
      }
    }
    # The same as above, but use `and` to ensure that we perform a correct join even with logical expressions
    by_artist_name_and_id_1: concerts(where: {concertArtists: {artist: {and: [{name: {eq: "A1b"}}, {id: {eq: $A1b_id}}]}}}) {
      id
      concertArtists {
        artist {
          id
          name
        }
      }
    }
    # Effectively same as the above, but the logical expression is performed at a higher level  
    by_artist_name_and_id_2: concerts(where: {concertArtists: {and: [{artist: {name: {eq: "A1b"}}}, {artist: {id: {eq: $A1b_id}}}]}}) {
      id
      concertArtists {
        artist {
          id
          name
        }
      }
    }
    by_artist_name_and_id_3: concerts(where: {and: [{concertArtists: {artist: {name: {eq: "A1b"}}}}, {concertArtists: {artist: {id: {eq: $A1b_id}}}}]}) {
      id
      concertArtists {
        artist {
          id
          name
        }
      }
    }            
  }
variable: |
  {
    "A1b_id": $.A1b_id
  }
response: |
  {
    "data": {
      "artist1_concerts": [
        {
          "id": $.c1_id,
          "concertArtists": [
            {
              "artist": {
                "id": $.A1a_id,
                "name": "A1a"
              }
            },
            {
              "artist": {
                "id": $.A1b_id,
                "name": "A1b"
              }
            },
            {
              "artist": {
                "id": $.A2a_id,
                "name": "A2a"
              }
            }
          ]
        },
        {
          "id": $.c2_id,
          "concertArtists": [
            {
              "artist": {
                "id": $.A1a_id,
                "name": "A1a"
              }
            },
            {
              "artist": {
                "id": $.A2a_id,
                "name": "A2a"
              }
            }
          ]
        }
      ],
      "artist2_concerts": [
        {
          "id": $.c1_id,
          "concertArtists": [
            {
              "artist": {
                "id": $.A1a_id,
                "name": "A1a"
              }
            },
            {
              "artist": {
                "id": $.A1b_id,
                "name": "A1b"
              }
            },
            {
              "artist": {
                "id": $.A2a_id,
                "name": "A2a"
              }
            }
          ]
        }
      ],
      "by_artist_name_and_id_1": [
        {
          "id": $.c1_id,
          "concertArtists": [
            {
              "artist": {
                "id": $.A1a_id,
                "name": "A1a"
              }
            },
            {
              "artist": {
                "id": $.A1b_id,
                "name": "A1b"
              }
            },
            {
              "artist": {
                "id": $.A2a_id,
                "name": "A2a"
              }
            }
          ]
        }
      ],
      "by_artist_name_and_id_2": [
        {
          "id": $.c1_id,
          "concertArtists": [
            {
              "artist": {
                "id": $.A1a_id,
                "name": "A1a"
              }
            },
            {
              "artist": {
                "id": $.A1b_id,
                "name": "A1b"
              }
            },
            {
              "artist": {
                "id": $.A2a_id,
                "name": "A2a"
              }
            }
          ]
        }
      ],
      "by_artist_name_and_id_3": [
        {
          "id": $.c1_id,
          "concertArtists": [
            {
              "artist": {
                "id": $.A1a_id,
                "name": "A1a"
              }
            },
            {
              "artist": {
                "id": $.A1b_id,
                "name": "A1b"
              }
            },
            {
              "artist": {
                "id": $.A2a_id,
                "name": "A2a"
              }
            }
          ]
        }
      ]                   
    }
  }
