context AuthContext {
  id: Int @jwt("sub")
  role: String @jwt("role")
}

@table("concerts")
@access(query=AuthContext.role == "ROLE_ADMIN" || AuthContext.role == "ROLE_USER", mutation=AuthContext.role == "ROLE_ADMIN")
model Concert {
  id: Int @pk @autoincrement
  title: String
  venue: Venue @column("venueid")
}

@table("venues")
@access(query=AuthContext.role == "ROLE_ADMIN" || self.published, mutation=AuthContext.role == "ROLE_ADMIN")
model Venue {
  id: Int @pk @autoincrement
  name: String
  concerts: [Concert] @column("venueid")
  published: Boolean
}
